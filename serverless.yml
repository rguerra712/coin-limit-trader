service: coin-limit-trader

provider:
  name: aws
  runtime: nodejs8.10
  stage: prod
  iamRoleStatements:
    - Effect: "Allow"
      Action: 
       - SNS:Publish
      Resource: arn:aws:sns:us-east-1:${env:AWS_ACCOUNT_ID}:scheduleTrade
  

plugins:
  - serverless-plugin-typescript
  - serverless-offline
  - serverless-dynamic-dotenv
  - serverless-offline-sns

functions:
  trade:
    handler: src/handlers/trade-api.trade
    timeout: 10
    events:
      - http:
          path: trade
          method: post

  trade-scheduler:
      handler: src/handlers/trade-scheduler.trade
      timeout: 30
      events:
        - sns:
            topicName: scheduleTrade
            displayName: Schedule coin trade with limit trades

custom:
  serverless-offline-sns:
    port: 4002
    debug: true